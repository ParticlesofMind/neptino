<!DOCTYPE html>
<html>
<head>
    <title>Path Tool Debug Test</title>
</head>
<body>
    <h1>Path Tool Debug Test</h1>
    <p>This test will help debug the path tool issue by adding objects to scenes programmatically.</p>
    
    <script>
        // Wait for the canvas to be ready
        setTimeout(() => {
            console.log('🧪 Starting Path Tool Debug Test');
            
            // Check if canvas API is available
            if (!window.canvasAPI) {
                console.error('❌ Canvas API not available');
                return;
            }
            
            // Check if we're in animate mode
            if (!window.toolStateManager) {
                console.error('❌ Tool State Manager not available');
                return;
            }
            
            // Switch to animate mode
            console.log('🧪 Switching to animate mode');
            window.toolStateManager.setMode('animate');
            
            // Switch to scene tool and create a scene
            console.log('🧪 Creating a test scene');
            window.toolStateManager.setTool('scene');
            
            // Add a text object to the canvas first
            setTimeout(() => {
                console.log('🧪 Adding a text object');
                window.toolStateManager.setTool('text');
                
                // Simulate clicking on canvas to add text
                const canvas = document.querySelector('#pixi-canvas');
                if (canvas) {
                    const rect = canvas.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    
                    // Create synthetic click event
                    const clickEvent = new MouseEvent('click', {
                        clientX: centerX,
                        clientY: centerY,
                        bubbles: true
                    });
                    canvas.dispatchEvent(clickEvent);
                    
                    console.log('🧪 Text click event dispatched');
                }
                
                // Check scenes and their content after a delay
                setTimeout(() => {
                    console.log('🧪 Checking scenes and their content:');
                    const scenes = window.animationState?.getScenes() || [];
                    console.log('🧪 Found', scenes.length, 'scenes');
                    
                    scenes.forEach((scene, index) => {
                        console.log(`🧪 Scene ${index + 1}:`, scene.getId());
                        const contentContainer = scene.getContentContainer();
                        console.log(`🧪 Scene ${index + 1} content children:`, contentContainer.children.length);
                        
                        if (contentContainer.children.length > 0) {
                            contentContainer.children.forEach((child, childIndex) => {
                                console.log(`🧪   Child ${childIndex + 1}:`, child.constructor.name, child);
                            });
                        }
                    });
                    
                    // Now test the path tool
                    console.log('🧪 Testing path tool');
                    window.toolStateManager.setTool('path');
                    
                }, 2000);
                
            }, 1000);
            
        }, 3000);
    </script>
</body>
</html>
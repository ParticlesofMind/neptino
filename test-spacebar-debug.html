<!DOCTYPE html>
<html>
<head>
    <title>Spacebar Debug Test</title>
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        #test-area { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        button { margin: 5px; padding: 5px 10px; }
        .debug-info { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>Spacebar Cursor Debug Test</h1>
    
    <div id="test-area">
        <p>1. Open browser console</p>
        <p>2. Go to coursebuilder page</p>
        <p>3. Activate text tool</p>
        <p>4. Create a text area</p>
        <p>5. Run this debug code in console:</p>
    </div>
    
    <div class="debug-info">
        <h3>Debug Script (copy to console):</h3>
        <code>
// Debug spacebar cursor positioning<br>
const textTool = window.textTool;<br>
const activeArea = textTool?.activeTextAreaPublic;<br>
const cursor = textTool?.textCursorPublic;<br>
<br>
if (!activeArea || !cursor) {<br>
&nbsp;&nbsp;console.log('‚ùå No active text area or cursor found');<br>
} else {<br>
&nbsp;&nbsp;console.log('‚úÖ Active text area found');<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;// Test character positions<br>
&nbsp;&nbsp;const testString = 'Hello World';<br>
&nbsp;&nbsp;activeArea.updateText(testString);<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;// Check position of each character<br>
&nbsp;&nbsp;for (let i = 0; i <= testString.length; i++) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;const pos = activeArea.getCharacterPosition(i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;const char = i < testString.length ? testString[i] : '[END]';<br>
&nbsp;&nbsp;&nbsp;&nbsp;console.log(`Position ${i} (${char}): x=${pos.x}, y=${pos.y}`);<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;// Test cursor movement to space position<br>
&nbsp;&nbsp;const spaceIndex = 5; // Position of space in "Hello World"<br>
&nbsp;&nbsp;cursor.setPosition(spaceIndex);<br>
&nbsp;&nbsp;const spacePos = activeArea.getCharacterPosition(spaceIndex);<br>
&nbsp;&nbsp;cursor.setGraphicsPosition(spacePos.x, spacePos.y);<br>
&nbsp;&nbsp;cursor.setVisible(true);<br>
&nbsp;&nbsp;cursor.startBlinking();<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;console.log(`üéØ Cursor moved to space position: ${spacePos.x}, ${spacePos.y}`);<br>
}<br>
        </code>
    </div>
    
    <div class="debug-info">
        <h3>Alternative: Test insertCharacter directly</h3>
        <code>
// Test if insertCharacter updates cursor properly<br>
const inputHandler = window.textTool?.inputHandlerPublic;<br>
if (inputHandler) {<br>
&nbsp;&nbsp;// Clear text first<br>
&nbsp;&nbsp;window.textTool.activeTextAreaPublic?.updateText('');<br>
&nbsp;&nbsp;inputHandler.currentCursorPosition = 0;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;// Insert characters one by one and check cursor<br>
&nbsp;&nbsp;const chars = ['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd'];<br>
&nbsp;&nbsp;chars.forEach((char, i) => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;console.log(`Before insert '${char}': cursor at ${inputHandler.currentCursorPosition}`);<br>
&nbsp;&nbsp;&nbsp;&nbsp;inputHandler.insertCharacter(char);<br>
&nbsp;&nbsp;&nbsp;&nbsp;console.log(`After insert '${char}': cursor at ${inputHandler.currentCursorPosition}`);<br>
&nbsp;&nbsp;&nbsp;&nbsp;const pos = window.textTool.activeTextAreaPublic?.getCharacterPosition(inputHandler.currentCursorPosition);<br>
&nbsp;&nbsp;&nbsp;&nbsp;console.log(`Cursor graphics pos: x=${pos?.x}, y=${pos?.y}`);<br>
&nbsp;&nbsp;&nbsp;&nbsp;console.log(`Visual cursor pos: x=${window.textTool.textCursorPublic?.pixiGraphics?.x}, y=${window.textTool.textCursorPublic?.pixiGraphics?.y}`);<br>
&nbsp;&nbsp;});<br>
} else {<br>
&nbsp;&nbsp;console.log('‚ùå No input handler found');<br>
}<br>
        </code>
    </div>
    
    <script>
        console.log('üîß Spacebar Debug Test loaded. Go to coursebuilder and run the debug scripts above.');
    </script>
</body>
</html>
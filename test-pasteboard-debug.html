<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasteboard Test</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        #canvas-container { 
            width: 800px; 
            height: 600px; 
            border: 2px solid #333; 
            margin: 20px 0;
            position: relative;
        }
        .debug-info {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>Extended Working Area Test</h1>
    <div id="canvas-container"></div>
    
    <div class="debug-info" id="debug-info">
        Loading canvas...
    </div>
    
    <button onclick="debugPasteboard()">Debug Pasteboard</button>
    <button onclick="testHitArea()">Test Hit Area</button>

    <script type="module">
        import { CanvasAPI } from '/src/scripts/coursebuilder/canvas/CanvasAPI.ts';
        import { pasteboardManager } from '/src/scripts/coursebuilder/canvas/PasteboardManager.ts';
        
        let canvasAPI = null;
        
        async function initCanvas() {
            try {
                console.log('ðŸŽ¯ Initializing canvas with extended working area...');
                
                // Initialize canvas
                canvasAPI = new CanvasAPI('#canvas-container');
                await canvasAPI.init({
                    width: 400,  // Smaller for testing
                    height: 300,
                    backgroundColor: 0xffffff
                });
                
                // Get debug info
                const app = canvasAPI.getApp();
                const pasteboardInfo = pasteboardManager.getDebugInfo();
                
                document.getElementById('debug-info').innerHTML = `
                    <strong>Canvas Info:</strong><br>
                    Canvas Size: ${app.screen.width} Ã— ${app.screen.height}<br>
                    Hit Area: ${JSON.stringify({
                        x: app.stage.hitArea.x,
                        y: app.stage.hitArea.y, 
                        width: app.stage.hitArea.width,
                        height: app.stage.hitArea.height
                    })}<br><br>
                    <strong>Pasteboard Info:</strong><br>
                    ${JSON.stringify(pasteboardInfo, null, 2).replace(/\n/g, '<br>').replace(/ /g, '&nbsp;')}
                `;
                
                console.log('âœ… Extended working area initialized!');
                console.log('Canvas screen:', app.screen);
                console.log('Hit area:', app.stage.hitArea);
                console.log('Pasteboard info:', pasteboardInfo);
                
            } catch (error) {
                console.error('âŒ Failed to initialize canvas:', error);
                document.getElementById('debug-info').innerHTML = `Error: ${error.message}`;
            }
        }
        
        window.debugPasteboard = function() {
            if (canvasAPI) {
                const info = pasteboardManager.getDebugInfo();
                console.log('ðŸ“ Pasteboard Debug Info:', info);
                alert(JSON.stringify(info, null, 2));
            }
        };
        
        window.testHitArea = function() {
            if (canvasAPI) {
                const app = canvasAPI.getApp();
                console.log('ðŸŽ¯ Hit Area Test:');
                console.log('Stage hit area:', app.stage.hitArea);
                console.log('Screen dimensions:', app.screen);
                
                // Test points
                const testPoints = [
                    { x: 200, y: 150, name: "Center" },
                    { x: 0, y: 0, name: "Top-left corner" },
                    { x: 400, y: 300, name: "Bottom-right corner" },
                    { x: -100, y: 150, name: "Left of canvas" },
                    { x: 500, y: 150, name: "Right of canvas" },
                    { x: 200, y: -50, name: "Above canvas" },
                    { x: 200, y: 350, name: "Below canvas" }
                ];
                
                testPoints.forEach(point => {
                    const inPasteboard = pasteboardManager.isPointInPasteboard(point.x, point.y);
                    const inCanvas = pasteboardManager.isPointInCanvas(point.x, point.y);
                    console.log(`${point.name} (${point.x}, ${point.y}): Canvas=${inCanvas}, Pasteboard=${inPasteboard}`);
                });
            }
        };
        
        // Initialize when page loads
        initCanvas();
    </script>
</body>
</html>
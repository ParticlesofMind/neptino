<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="pixi-devtools" content="enabled" />
  <title>Course Builder - Neptino</title>

  <!-- Select2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

  <link rel="stylesheet" href="/src/scss/main.scss" />
</head>

<body class="grid body">
  <header class="grid__header header">
    <nav class="nav">
      <ul class="ul ul--header">
        <li class="ul__item">
          <button class="button button--outline button--small" id="previous-btn" title="Previous Step">
            Previous
          </button>
        </li>

        <li class="ul__item">
          <a class="link link--header" href="/src/pages/teacher/home.html" title="Back to Home">
            <img class="logo logo--small" src="/src/assets/logo/octopus-logo.png" alt="Neptino Logo" />
          </a>
        </li>

        <li class="ul__item">
          <button class="button button--outline button--small" id="next-btn" title="Next Step">
            Next
          </button>
        </li>
      </ul>
    </nav>
  </header>
  <main class="grid__main coursebuilder">
    <!-- Setup View -->
    <div class="coursebuilder__setup" aria-hidden="false" id="setup">
      <aside class="sidebar">
        <nav class="ul ul--sidebar">
          <ul class="ul ul--menu">
            <li class="ul__item ul__item--heading">
              <h3 class="heading heading--sidebar">Setup</h3>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#essentials" data-section="essentials">Essentials</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#classification" data-section="classification">Classification</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#students" data-section="students">Students</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#pedagogy" data-section="pedagogy">Pedagogy</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#templates" data-section="templates">Templates</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#schedule" data-section="schedule">Schedule</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#curriculum" data-section="curriculum">Curriculum</a>
            </li>
            <li class="ul__item ul__item--heading">
              <h3 class="heading heading--sidebar">Publishing</h3>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#course-visibility" data-section="course-visibility">Course
                visibility</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#marketplace" data-section="marketplace">Marketplace</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#pricing-monetization" data-section="pricing-monetization">Pricing &
                Monetization</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#external-integrations" data-section="external-integrations">External
                Integrations & APIs</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#communication" data-section="communication">Communication</a>
            </li>
            <li class="ul__item ul__item--heading">
              <h3 class="heading heading--sidebar">Engine</h3>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#page-setup" data-section="page-setup">Page Setup</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#interface" data-section="interface">Interface</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#themes" data-section="themes">Themes</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#accessibility-comfort"
                data-section="accessibility-comfort">Accessibility & Comfort</a>
            </li>
            <li class="ul__item ul__item--heading">
              <h3 class="heading heading--sidebar">Settings</h3>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#notifications-alerts" data-section="notifications-alerts">Notifications
                & Alerts</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#data-management" data-section="data-management">Data management &
                Backup</a>
            </li>
            <li class="ul__item">
              <a class="link link--menu" href="#advanced-settings" data-section="advanced-settings">Advanced
                Settings</a>
            </li>
          </ul>
        </nav>
      </aside>

      <div class="content">
        <!-- Essentials Article -->
        <article id="essentials" class="content__article content__article--active">
          <form class="form" id="course-essentials-form">
            <label class="form__label">
              Course Name
              <input class="input" type="text" name="course_name" placeholder="Enter course name" required />
            </label>
            <label class="form__label">
              Course Description
              <textarea class="form__textarea" name="course_description" rows="4"
                placeholder="Describe what students will learn" required></textarea>
            </label>
            <label class="form__label">
              Teacher
              <input class="input" type="text" name="teacher_id" placeholder="Loading..." readonly />
            </label>
            <label class="form__label">
              Institution
              <input class="input" type="text" name="institution" placeholder="Loading..." readonly />
            </label>
            <label class="form__label">
              Course Language
              <select class="input input--select" name="course_language" required>
                <option value="">Select language...</option>
              </select>
            </label>
            <label class="form__label">
              Course Image
              <input class="input input--file" type="file" name="course_image" accept="image/*" required />
              <div class="image-upload__preview" id="image-preview" style="display: none">
                <img class="image-upload__img" id="preview-img" src="" alt="Course preview" />
                <button class="button button--small image-upload__remove" type="button" id="remove-image">
                  Ã—
                </button>
              </div>
            </label>
            <button class="button button--primary button--medium" type="submit" id="save-essentials-btn">
              Save Course Details
            </button>
          </form>
        </article>
        <!-- Classification Article -->
        <article class="content__article" id="classification">
          <form class="form classification" id="course-classification-form">

            <!-- Row 1: Basic Information -->
            <div class="classification__row classification__row--basic">
              <div class="classification__field">
                <label class="form__label" for="class-year-select">
                  Class Year
                </label>
                <select class="input input--select" name="class_year" id="class-year-select" required>
                  <option value="">Loading...</option>
                </select>
              </div>

              <div class="classification__field">
                <label class="form__label" for="curricular-framework-select">
                  Curricular Framework
                </label>
                <select class="input input--select" name="curricular_framework" id="curricular-framework-select"
                  required>
                  <option value="">Loading...</option>
                </select>
              </div>
            </div>

            <!-- Row 2: Academic Hierarchy -->
            <div class="classification__row classification__row--hierarchy">
              <div class="classification__field">
                <label class="form__label" for="domain-select">
                  Domain
                  <span class="form__label-hint">Academic field</span>
                </label>
                <select class="input input--select" name="domain" id="domain-select" required>
                  <option value="">Loading...</option>
                </select>
              </div>

              <div class="classification__field">
                <label class="form__label" for="subject-select">
                  Subject
                  <span class="form__label-hint">Specific discipline</span>
                </label>
                <select class="input input--select" name="subject" id="subject-select" required disabled>
                  <option value="">Select domain first...</option>
                </select>
              </div>

              <div class="classification__field">
                <label class="form__label" for="topic-select">
                  Topic
                  <span class="form__label-hint">Area of study</span>
                </label>
                <select class="input input--select" name="topic" id="topic-select" required disabled>
                  <option value="">Select subject first...</option>
                </select>
              </div>

              <div class="classification__field">
                <label class="form__label" for="subtopic-select">
                  Subtopic
                  <span class="form__label-optional">(Optional)</span>
                  <span class="form__label-hint">Specific focus</span>
                </label>
                <select class="input input--select" name="subtopic" id="subtopic-select" disabled>
                  <option value="">Select topic first...</option>
                </select>
              </div>
            </div>

            <!-- Course Sequence Section -->
            <div class="classification__section">
              <div class="classification__section-header">
                <h3 class="classification__section-title">
                  Course Sequence
                  <span class="form__label-optional">(Optional)</span>
                </h3>
                <p class="classification__section-description">
                  Define how this course fits into a learning sequence
                </p>
              </div>

              <!-- Row 3: Course Sequence -->
              <div class="classification__row classification__row--sequence">
                <div class="classification__field">
                  <label class="form__label" for="previous-course-select">
                    Previous Course
                    <span class="form__label-hint">Course that should come before this one</span>
                  </label>
                  <select class="input input--select" name="previous_course" id="previous-course-select">
                    <option value="">Loading courses...</option>
                  </select>
                </div>

                <div class="classification__field">
                  <label class="form__label" for="current-course-select">
                    Current Course
                    <span class="form__label-hint">Other courses at this level</span>
                  </label>
                  <select class="input input--select" name="current_course" id="current-course-select">
                    <option value="">Loading courses...</option>
                  </select>
                </div>

                <div class="classification__field">
                  <label class="form__label" for="next-course-select">
                    Next Course
                    <span class="form__label-hint">Course that should come after this one</span>
                  </label>
                  <select class="input input--select" name="next_course" id="next-course-select">
                    <option value="">Loading courses...</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Save Status -->
            <div class="classification__status save-status" id="classification-save-status">
              <span class="classification__status-text save-status__text">Changes will be saved automatically</span>
            </div>
          </form>
        </article>
        <!-- Templates Article -->
        <article class="content__article" id="templates">
          <!-- Template Actions -->


          <!-- Template Builder -->
          <div class="template">
            <div class="template__buttons">
              <button class="button button--primary" id="create-template-btn">
                + Create New Template
              </button>
              <button class="button button--outline" id="load-template-btn">
                â†— Load Template
              </button>
            </div>


            <div class="template__config">
              <h3 class="header">Template Configuration</h3>
              <div class="template__content" id="template-config-content">
                <p>Select or create a template to configure its settings.</p>
              </div>
            </div>

            <div class="template__preview">
              <h3 class="header">Template Preview</h3>
              <div class="template__content" id="template-preview-content">
                <p>Create a new template or select an existing one to see the preview here.</p>
              </div>
            </div>
          </div>

        </article>
        <!-- Create Template Modal -->
        <div class="modal coursebuilder-modal" id="create-template-modal">
          <div class="modal__backdrop">
            <div class="modal__content">
              <div class="modal__header">
                <h2 class="modal__title">Create New Template</h2>
                <button class="button button--subtle button--small modal__close" type="button"
                  onclick="TemplateManager.hideCreateTemplateModal()">
                  &times;
                </button>
              </div>

              <form class="form coursebuilder-form modal__body" id="create-template-form">
                <label class="form__label">
                  Template Name*
                  <input class="input" type="text" name="template-name" required placeholder="Enter template name" />
                </label>

                <label class="form__label">
                  Template Type*
                  <select class="input input--select" name="template-type" required>
                    <option value="">Select template type</option>
                    <option value="lesson">Lesson</option>
                  </select>
                </label>

                <label class="form__label">
                  Description (Optional)
                  <textarea class="form__textarea" name="template-description" rows="3"
                    placeholder="Describe your template..."></textarea>
                </label>

                <div class="modal__footer">
                  <button class="button button--outline" type="button"
                    onclick="TemplateManager.hideCreateTemplateModal()">
                    Cancel
                  </button>
                  <button class="button button--primary" type="submit">
                    Create Template
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- Load Template Modal -->
        <div class="modal coursebuilder-modal" id="load-template-modal">
          <div class="modal__backdrop">
            <div class="modal__content">
              <div class="modal__header">
                <h2 class="modal__title">Load Existing Template</h2>
                <button class="button button--subtle button--small modal__close" type="button"
                  onclick="TemplateManager.hideLoadTemplateModal()">
                  &times;
                </button>
              </div>

              <div class="modal__body template-browser">
                <div class="template-browser__controls">
                  <input class="input" type="text" id="template-search" placeholder="Search templates..." />
                  <select class="input input--select" id="template-type-filter">
                    <option value="">All Types</option>
                    <option value="lesson">Lesson</option>
                  </select>
                </div>

                <div class="template-browser__content">
                  <div class="template-browser__loading" id="template-loading" style="display: none">
                    <p>Loading your templates...</p>
                  </div>

                  <div class="template-browser__list" id="template-list-content" style="display: none">
                    <!-- Templates will be populated here by JavaScript -->
                  </div>

                  <div class="template-browser__empty" id="no-templates-message" style="display: none">
                    <div class="template-browser__empty-icon">ðŸ“„</div>
                    <h3 class="template-browser__empty-title">No Templates Found</h3>
                    <p class="template-browser__empty-text">
                      You haven't created any templates yet. Create your first template to get started!
                    </p>
                    <button class="button button--primary template-browser__empty-action"
                      onclick="TemplateManager.hideLoadTemplateModal(); TemplateManager.showCreateTemplateModal();">
                      Create First Template
                    </button>
                  </div>
                </div>
              </div>

              <div class="modal__footer">
                <button class="button button--outline" type="button" onclick="TemplateManager.hideLoadTemplateModal()">
                  Cancel
                </button>
                <button class="button button--primary" type="button" id="load-selected-template" disabled
                  onclick="TemplateManager.loadSelectedTemplate()">
                  Load Template
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- Schedule Article -->
        <article class="content__article" id="schedule">
          <!-- Schedule Layout -->
          <div class="schedule">
            <!-- Schedule Configuration -->
            <div class="schedule__config" id="schedule-config">
              <h3 class="schedule__heading">Schedule Configuration</h3>

              <form class="form" id="course-schedule-form">
                <!-- Date Range Field Group -->
                <div class="schedule__field-group">
                  <label class="form__label">
                    Start Date
                    <input class="input input--date" type="date" id="start-date" required />
                  </label>
                  <label class="form__label">
                    End Date
                    <input class="input input--date" type="date" id="end-date" required />
                  </label>
                </div>

                <!-- Days of Week Selection -->
                <label class="form__label">
                  Days of the Week
                  <div class="schedule__days">
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="monday">
                      Mon
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="tuesday">
                      Tue
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="wednesday">
                      Wed
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="thursday">
                      Thu
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="friday">
                      Fri
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="saturday">
                      Sat
                    </button>
                    <button class="button button--outline button--small schedule__day-button" type="button"
                      data-day="sunday">
                      Sun
                    </button>
                  </div>
                </label>

                <!-- Time Range Field Group -->
                <div class="schedule__field-group">
                  <label class="form__label">
                    Start Time
                    <input class="input input--time" type="time" id="start-time" required />
                  </label>
                  <label class="form__label">
                    End Time
                    <input class="input input--time" type="time" id="end-time" required />
                  </label>
                </div>

                <!-- Schedule Action Buttons -->
                <div class="button-group">
                  <button class="button button--primary" type="button" id="schedule-course-btn" disabled>
                    Schedule Course
                  </button>
                  <button class="button button--delete" type="button" id="delete-schedule-btn" style="display: none;">
                    Delete Schedule
                  </button>
                </div>
              </form>
            </div>

            <!-- Schedule Preview -->
            <div class="schedule__preview" id="schedule-preview">
              <h3 class="schedule__heading">Schedule Preview</h3>
              <div class="schedule__content">
                <!-- Schedule rows will be generated here by JavaScript -->
                <div class="schedule__placeholder">
                  <p>Click "Schedule Course" to generate your lesson schedule</p>
                </div>
              </div>
              <div class="schedule__total">Total lessons: 0</div>
            </div>


          </div>
        </article>
        <!-- Curriculum Article -->
        <article class="content__article" id="curriculum">
          <div class="curriculum">
            <div class="curriculum__config">
              <h3 class="heading">Curriculum Configuration</h3>

              <div class="curriculum__duration">
                <button class="button button--outline" type="button" data-duration="mini" data-max="30">
                  Mini
                </button>
                <button class="button button--outline" type="button" data-duration="single" data-max="60">
                  Single
                </button>
                <button class="button button--outline" type="button" data-duration="double" data-max="120">
                  Double
                </button>
                <button class="button button--outline" type="button" data-duration="triple" data-max="180">
                  Triple
                </button>
                <button class="button button--outline" type="button" data-duration="halfFull" data-max="999">
                  Half/Full day
                </button>
              </div>

              <div class="card card--rounded curriculum__duration-info" id="curriculum-duration-info"
                style="display: none;">
                <div class="card__content">
                  <span class="curriculum__duration-text">Select a lesson duration above to see the ideal lesson
                    length</span>
                </div>
              </div>

              <div class="curriculum__recommendation" id="curriculum-recommendation">
                Select a lesson duration to see recommendations
              </div>

              <div class="curriculum__structure">
                <label class="form__label">
                  Topics per lesson
                  <input class="input input--number" type="number" min="1" max="10" value="2" id="curriculum-topics" />
                </label>

                <label class="form__label">
                  Objectives per topic
                  <input class="input input--number" type="number" min="1" max="5" value="2"
                    id="curriculum-objectives" />
                </label>

                <label class="form__label">
                  Tasks per objective
                  <input class="input input--number" type="number" min="1" max="5" value="2" id="curriculum-tasks" />
                </label>
              </div>
            </div>

            <div class="curriculum__preview">
              <div class="curriculum__controls">

                <div class="button-group">
                  <button class="button button--small button--outline" type="button" data-mode="titles">
                    Titles
                  </button>
                  <button class="button button--small button--outline" type="button" data-mode="topics">
                    Topics
                  </button>
                  <button class="button button--small button--outline" type="button" data-mode="objectives">
                    Objectives
                  </button>
                  <button class="button button--small button--outline" type="button" data-mode="tasks">
                    Tasks
                  </button>
                  <button class="button button--small button--outline" type="button" data-mode="all">
                    All
                  </button>
                </div>
              </div>

              <div class="curriculum__content">
                <!-- Dynamic content -->
              </div>
            </div>
          </div>
        </article>
        <!-- Settings Article -->
        <article class="content__article" id="settings">
          <div class="placeholder">
            <!-- General settings content will be added here -->
          </div>
        </article>
        <!-- Marketplace Article -->

        <article class="content__article" id="marketplace">
          <p class="placeholder">
            Marketplace integration features will be available here...
          </p>
        </article>

        <!-- Resources Article -->
        <article class="content__article" id="resources">
          <div class="placeholder">
            <!-- Resources content will be added here -->
          </div>
        </article>

        <!-- Students Article -->
        <article class="content__article" id="students">
          <div class="placeholder">
            <!-- Students content will be added here -->
          </div>
        </article>

        <!-- Pedagogy Article -->
        <article class="content__article" id="pedagogy">
          <form class="form pedagogy" id="course-pedagogy-form">
            <input type="hidden" name="course_pedagogy" id="course-pedagogy-input" />

            <div class="pedagogy-ui" id="pedagogy-ui">
              <div class="pedagogy-ui__left">
                <div class="pedagogy-grid" id="pedagogy-grid" role="application" aria-label="Pedagogical coordinate plane" tabindex="0">
                  <!-- Grid backdrop via CSS; central axes via pseudo elements -->
                  <div class="axis-label axis-label--left">Essentialist</div>
                  <div class="axis-label axis-label--right">Progressive</div>
                  <div class="axis-label axis-label--top">Constructivist</div>
                  <div class="axis-label axis-label--bottom">Behaviorist</div>
                  <div class="pedagogy-grid__marker" id="pedagogy-marker" aria-hidden="true"></div>
                </div>

                <div class="pedagogy-ui__coords">
                  <div class="coord-display">
                    <div class="coord-display__label">X</div>
                    <div class="coord-display__value" id="pedagogy-x">0</div>
                  </div>
                  <div class="coord-display">
                    <div class="coord-display__label">Y</div>
                    <div class="coord-display__value" id="pedagogy-y">0</div>
                  </div>
                </div>

                <div class="pedagogy-ui__presets">
                  <button type="button" class="button button--preset" data-x="-75" data-y="-75">Traditional</button>
                  <button type="button" class="button button--preset" data-x="75" data-y="75">Progressive</button>
                  <button type="button" class="button button--preset" data-x="-25" data-y="75">Guided Discovery</button>
                  <button type="button" class="button button--preset" data-x="0" data-y="0">Balanced</button>
                </div>
              </div>

              <div class="pedagogy-ui__right">
                <section class="pedagogy-summary">
                  <h3 class="pedagogy-summary__title" id="pedagogy-approach-title">Balanced</h3>
                  <div class="pedagogy-summary__subtitle" id="pedagogy-approach-subtitle"><em>Essentialist Ã— Behaviorist â†” Progressive Ã— Constructivist</em></div>
                  <p class="pedagogy-summary__description" id="pedagogy-approach-desc">
                    A balanced blend of teacher guidance, student agency, and mixed knowledge construction.
                  </p>

                  <h4 class="pedagogy-impact__heading">Implementation Impact</h4>
                  <ul class="pedagogy-impact__list" id="pedagogy-impact-list">
                    <!-- Dynamic bullets injected by script -->
                  </ul>
                </section>
              </div>
            </div>

            <div class="save-status" id="pedagogy-save-status">
              <span class="save-status__text">Changes will be saved automatically</span>
            </div>
          </form>
        </article>

        <!-- Course Visibility Article -->
        <article class="content__article" id="course-visibility">
          <!-- Course Visibility Settings -->
          <div class="settings__section">
            <h4 class="settings__heading">Course Visibility</h4>
            <form class="form" id="course-settings-form">
              <div class="settings__checkboxes">
                <label class="form__label">
                  <input class="input input--checkbox" type="checkbox" name="course_visible" />
                  Course visible to students
                </label>

                <label class="form__label">
                  <input class="input input--checkbox" type="checkbox" name="allow_enrollment" />
                  Allow new enrollments
                </label>

                <label class="form__label">
                  <input class="input input--checkbox" type="checkbox" name="require_approval" />
                  Require enrollment approval
                </label>

                <label class="form__label">
                  <input class="input input--checkbox" type="checkbox" name="enable_notifications" />
                  Enable email notifications for new enrollments
                </label>

                <label class="form__label">
                  <input class="input input--checkbox" type="checkbox" name="public_course" />
                  Make course publicly discoverable
                </label>

                <div class="settings__status" id="settings-last-saved">
                  <span class="settings__status-text" id="settings-save-status">
                    Changes will be saved automatically
                  </span>
                </div>
              </div>
            </form>
          </div>
        </article>

        <!-- Pricing & Monetization Article -->
        <article class="content__article" id="pricing-monetization">
          <div class="placeholder">
            <!-- Pricing & Monetization content will be added here -->
          </div>
        </article>

        <!-- External Integrations & APIs Article -->
        <article class="content__article" id="external-integrations">
          <div class="placeholder">
            <!-- External Integrations & APIs content will be added here -->
          </div>
        </article>

        <!-- Communication Article -->
        <article class="content__article" id="communication">
          <div class="placeholder">
            <!-- Communication content will be added here -->
          </div>
        </article>

        <!-- Page Setup Article -->
        <article class="content__article" id="page-setup">
          <div class="page-setup">
            <div class="page-setup__config">
              <h3 class="header">Page Configuration</h3>
              <div class="page-setup__content">
                <!-- Units -->
                <div class="page-setup__section">
                  <label class="page-setup__label">Units</label>
                  <div class="page-setup__options page-setup__options--horizontal">
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="units" value="cm" checked />
                      Metric (cm)
                    </label>
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="units" value="inches" />
                      Imperial (inches)
                    </label>
                  </div>
                </div>

                <!-- Orientation -->
                <div class="page-setup__section">
                  <label class="page-setup__label">Orientation</label>
                  <div class="page-setup__options">
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="orientation" value="portrait" checked />
                      Portrait
                    </label>
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="orientation" value="landscape" />
                      Landscape
                    </label>
                  </div>
                </div>

                <!-- Canvas Size -->
                <div class="page-setup__section">
                  <label class="page-setup__label">Canvas Size</label>
                  <div class="page-setup__options">
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="canvas-size" value="a4" checked />
                      <span class="canvas-size-label" data-cm="A4 (21.0 Ã— 29.7 cm)"
                        data-inches="A4 (8.27&quot; Ã— 11.69&quot;)">A4 (21.0 Ã— 29.7 cm)</span>
                    </label>
                    <label class="page-setup__option">
                      <input class="input input--radio" type="radio" name="canvas-size" value="us-letter" />
                      <span class="canvas-size-label" data-cm="US Letter (21.6 Ã— 27.9 cm)"
                        data-inches="US Letter (8.5&quot; Ã— 11&quot;)">US Letter (21.6 Ã— 27.9 cm)</span>
                    </label>
                  </div>
                </div>

                <!-- Margins -->
                <div class="page-setup__section">
                  <label class="page-setup__label">Margins</label>
                  <div class="page-setup__margins">
                    <div class="page-setup__margin-group">
                      <label class="page-setup__margin">
                        Top
                        <input class="input input--number" type="number" name="margin_top" value="2.54" step="0.01"
                          min="0" max="100" />
                        <span class="page-setup__unit">cm</span>
                      </label>
                      <label class="page-setup__margin">
                        Bottom
                        <input class="input input--number" type="number" name="margin_bottom" value="2.54" step="0.01"
                          min="0" max="100" />
                        <span class="page-setup__unit">cm</span>
                      </label>
                    </div>
                    <div class="page-setup__margin-group">
                      <label class="page-setup__margin">
                        Left
                        <input class="input input--number" type="number" name="margin_left" value="2.54" step="0.01"
                          min="0" max="100" />
                        <span class="page-setup__unit">cm</span>
                      </label>
                      <label class="page-setup__margin">
                        Right
                        <input class="input input--number" type="number" name="margin_right" value="2.54" step="0.01"
                          min="0" max="100" />
                        <span class="page-setup__unit">cm</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="page-setup__preview">
              <h3 class="header">Page Preview</h3>
              <div class="page-setup__canvas-container">
                <canvas class="page-setup__canvas" id="page-preview-canvas" width="400" height="500"></canvas>
                <div class="page-setup__canvas-info">
                  <span class="page-setup__dimensions" id="canvas-dimensions">210 Ã— 297 mm (A4 Portrait)</span>
                  <span class="page-setup__margins-info" id="margins-info">Margins: 2.54mm all sides</span>
                </div>
              </div>
            </div>
          </div>
        </article>

        <!-- Interface Article -->
        <article class="content__article" id="interface">
          <div class="placeholder">
            <!-- Interface content will be added here -->
          </div>
        </article>

        <!-- Themes Article -->
        <article class="content__article" id="themes">
          <div class="placeholder">
            <!-- Themes content will be added here -->
          </div>
        </article>

        <!-- Accessibility & Comfort Article -->
        <article class="content__article" id="accessibility-comfort">
          <div class="placeholder">
            <!-- Accessibility & Comfort content will be added here -->
          </div>
        </article>

        <!-- Notifications & Alerts Article -->
        <article class="content__article" id="notifications-alerts">
          <div class="placeholder">
            <!-- Notifications & Alerts content will be added here -->
          </div>
        </article>

        <!-- Data Management & Backup Article -->
        <article class="content__article" id="data-management">
          <div class="placeholder">
            <!-- Data Management & Backup content will be added here -->
          </div>
        </article>

        <!-- Advanced Settings Article -->
        <article class="content__article" id="advanced-settings">
          <!-- Danger Zone -->
          <div class="settings__section settings__section--danger">
            <h3 class="settings__heading settings__heading--danger">
              Danger Zone
            </h3>
            <p class="settings__description">
              Once you delete a course, there is no going back. Please be certain.
            </p>
            <button class="button button--delete" id="delete-course-btn">
              Delete Course
            </button>
          </div>
        </article>
      </div>
    </div>

    <!-- Create View -->
    <div class="coursebuilder__create" aria-hidden="true" id="create">
      <div class="engine">
        <!-- Mode Selector -->
        <div class="engine__mode mode">
          <div class="mode__item" data-mode="build">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/modes/mode-build.svg" alt="">
            <span class="icon-label">Build</span>
          </div>
          <div class="mode__item" data-mode="animate">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/modes/mode-animate.svg" alt="">
            <span class="icon-label">Animate</span>
          </div>
          <div class="mode__item" data-mode="workflow">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/modes/mode-workflow.svg" alt="">
            <span class="icon-label">Flow</span>
          </div>
          <div class="mode__item" data-mode="optimize">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/modes/mode-optimize.svg" alt="">
            <span class="icon-label">Improve</span>
          </div>
        </div>

        <!-- Media Selector -->
        <div class="engine__media media">
          <div class="media__item" data-media="files">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-files.svg" alt="">
            <span class="icon-label">Files</span>
          </div>
          <div class="media__item" data-media="images">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-image.svg" alt="">
            <span class="icon-label">Images</span>
          </div>
          <div class="media__item" data-media="videos">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-video.svg" alt="">
            <span class="icon-label">Videos</span>
          </div>
          <div class="media__item" data-media="audio">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-audio.svg" alt="">
            <span class="icon-label">Audio</span>
          </div>
          <div class="media__item" data-media="text">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-text.svg" alt="">
            <span class="icon-label">Text</span>
          </div>
          <div class="media__item" data-media="plugin">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-plugins.svg" alt="">
            <span class="icon-label">Plugins</span>
          </div>
          <div class="media__item" data-media="links">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-link.svg" alt="">
            <span class="icon-label">Links</span>
          </div>
          <div class="media__item" data-media="interactive">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/media/media-interactive.svg" alt="">
            <span class="icon-label">Interactive</span>
          </div>
        </div>

        <!-- Search -->
        <div class="engine__search search">
          <input class="search__input input input--search" type="search" placeholder="Search media..."
            id="media-search-input">
        </div>

        <!-- Canvas Area -->
        <div class="engine__canvas engine__canvas--grid" id="canvas-container">
          <!-- Column 1: Perspective Tools -->
          <div class="engine__perspective">
            <!-- Zoom Indicator -->
            <div class="zoom-display" title="Current zoom level - Ctrl/Cmd+wheel to zoom">100%</div>
            
            <div class="perspective__item" data-perspective="zoom-in" title="Zoom In">
              <img src="/src/assets/icons/coursebuilder/perspective/zoomin-icon.svg" alt="Zoom In"
                class="perspective__icon icon icon--base">
            </div>
            <div class="perspective__item" data-perspective="zoom-out" title="Zoom Out">
              <img src="/src/assets/icons/coursebuilder/perspective/zoomout-icon.svg" alt="Zoom Out"
                class="perspective__icon icon icon--base">
            </div>

               <div class="perspective__item" data-perspective="reset" title="Reset View">
              <img src="/src/assets/icons/coursebuilder/perspective/reset-icon.svg" alt="Reset View"
                class="perspective__icon icon icon--base">
            </div>

            
               <div class="perspective__item" data-perspective="grab" title="grab">
              <img src="/src/assets/icons/coursebuilder/perspective/grab-icon.svg" alt="grab"
                class="perspective__icon icon icon--base">
            </div>
            <!-- Grid button (opens Snap Menu) -->
            <div class="perspective__item" data-perspective="grid" title="Snapping" data-snap-anchor>
              <img src="/src/assets/icons/coursebuilder/perspective/grid-icon.svg" alt="Snapping"
                class="perspective__icon icon icon--base">
              <span class="icon-label">Grid</span>
            </div>
          </div>
          
          <!-- Snap Menu (positioned outside perspective tools) -->
          <div class="snap-menu" id="snap-menu" data-snap-menu>
            <div class="snap-menu__item snap-menu__item--active" data-snap-option="grid">
              <img class="icon icon--base" src="/src/assets/icons/coursebuilder/perspective/grid-icon.svg" alt="Grid"><span>Snap to Grid</span>
            </div>
            <div class="snap-menu__item" data-snap-option="smart">
              <img class="icon icon--base" src="/src/assets/icons/coursebuilder/perspective/snap-smart.svg" alt="Smart"><span>Smart Guides</span>
            </div>
            <!-- Preferences -->
            <div class="snap-menu__controls">
              <div class="snap-menu__row"><label>Snap Threshold</label><input type="number" min="0" max="50" step="1" value="6" data-snap-threshold></div>
              <div class="snap-menu__row"><label>Equal Tolerance</label><input type="number" min="0" max="10" step="1" value="1" data-snap-equaltol></div>
              <div class="snap-menu__row"><label><input type="checkbox" checked data-dim-match-width> Match Width</label></div>
              <div class="snap-menu__row"><label><input type="checkbox" checked data-dim-match-height> Match Height</label></div>
            </div>
            <!-- Distribute actions -->
            <div class="snap-menu__row">
              <div class="snap-menu__item" data-distribute="horizontal">
                <img class="icon icon--base" src="/src/assets/icons/coursebuilder/perspective/snap-smart.svg" alt="Distribute H"><span>Distribute Horizontally</span>
              </div>
              <div class="snap-menu__item" data-distribute="vertical">
                <img class="icon icon--base" src="/src/assets/icons/coursebuilder/perspective/snap-smart.svg" alt="Distribute V"><span>Distribute Vertically</span>
              </div>
            </div>
          </div>
          
          <!-- Column 2: Canvas will be inserted here by JavaScript -->
          <!-- Column 3: Empty space for future use -->
          <div class="engine__canvas-spacer"></div>
        </div>

        <!-- Canvas Navigation -->
        <div class="engine__nav-course nav-course">
          <div class="nav-course__item nav-course__item--active" data-preview="outline">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/navigation/navigation-toc.svg" alt="">
            <span class="icon-label">Outline</span>
          </div>
          <div class="nav-course__item" data-preview="preview">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/navigation/navigation-thumbnail.svg"
              alt="">
            <span class="icon-label">Preview</span>
          </div>
          <div class="nav-course__item" data-preview="marks">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/navigation/navigation-bookmark.svg"
              alt="">
            <span class="icon-label">Marks</span>
          </div>
          <div class="nav-course__item" data-preview="layers">
            <img class="icon icon--base" src="/src/assets/icons/coursebuilder/navigation/navigation-layers.svg" alt="Layers icon">
            <span class="icon-label">Layers</span>
          </div>
        </div>

        <!-- Canvas Preview -->
        <div class="engine__preview preview">
          <!-- Outline Preview -->
          <div class="preview__content preview__content--active" id="preview-outline">
            <div class="preview-placeholder">Outline content coming soon</div>
          </div>

          <!-- Canvas Preview -->
          <div class="preview__content" id="preview-canvas">
            <div class="preview-placeholder">Canvas preview coming soon</div>
          </div>

          <!-- Bookmarks/Marks Preview -->
          <div class="preview__content" id="preview-marks">
            <div class="preview-placeholder">Marks content coming soon</div>
          </div>

          <!-- Layers Panel -->
          <div class="preview__content" id="preview-layers">
            <div class="layers-panel">
              <div class="layers-controls button-group" style="display:flex; gap:8px; padding:6px 4px;">
                <button id="layers-group" class="button button--small button--outline">Group</button>
                <button id="layers-ungroup" class="button button--small button--outline">Ungroup</button>
              </div>
              <ol class="layers-list" id="layers-list-root"></ol>
            </div>
          </div>
        </div>

        <!-- Drawing Tools -->
        <div class="engine__tools tools">
          <!-- Build Mode Tools -->
          <div class="tools__selection tools__selection--build" data-mode-tools="build">
            <div class="tools__item tools__item--active" data-tool="selection">
              <img src="/src/assets/icons/coursebuilder/tools/tool-select.svg" alt="Selection Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Select</span>
            </div>
            <div class="tools__item" data-tool="pen">
              <img src="/src/assets/icons/coursebuilder/tools/tool-pen.svg" alt="Pen Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Pen</span>
            </div>
            <div class="tools__item" data-tool="brush">
              <img src="/src/assets/icons/coursebuilder/tools/tool-brush.svg" alt="Brush Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Brush</span>
            </div>
            <div class="tools__item" data-tool="text">
              <img src="/src/assets/icons/coursebuilder/tools/tool-write.svg" alt="Text Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Text</span>
            </div>
            <div class="tools__item" data-tool="shapes">
              <img src="/src/assets/icons/coursebuilder/tools/tool-shapes.svg" alt="Shapes Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Shapes</span>
            </div>
            <div class="tools__item" data-tool="tables">
              <img src="/src/assets/icons/coursebuilder/media/media-table.svg" alt="Table Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Tables</span>
            </div>
            <div class="tools__item" data-tool="eraser">
              <img src="/src/assets/icons/coursebuilder/tools/tool-eraser.svg" alt="Eraser Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Eraser</span>
            </div>
          </div>

          <!-- Animate Mode Tools -->
          <div class="tools__selection tools__selection--animate" data-mode-tools="animate" style="display: none;">
            <div class="tools__item tools__item--active" data-tool="selection">
              <img src="/src/assets/icons/coursebuilder/tools/tool-select.svg" alt="Selection Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Select</span>
            </div>
            <div class="tools__item" data-tool="scene">
              <img src="/src/assets/icons/coursebuilder/modes/mode-animate.svg" alt="Scene Tool"
                class="tools__icon icon icon--base">
              <span class="icon-label">Scene</span>
            </div>
          </div>

          <!-- Tool Settings -->
          <div class="tools__options">

            <!-- Pen Settings -->
            <div class="tools__item tools__item--pen" style="display: none;">
              <input type="number" min="1" max="15" value="2" class="input input--number" title="Pen Size"
                data-setting="size">


              <select id="pen-stroke-select" class="input input--color" data-color-selector="pen-stroke"
                title="Stroke Color">
                <option value="#1a1a1a" data-color="#1a1a1a" selected>Black</option>
                <option value="#4a7c59" data-color="#4a7c59">Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc">White</option>
              </select>
              <select id="pen-fill-select" class="input input--color" data-color-selector="pen-fill" title="Fill Color">
                <option value="transparent" data-color="transparent">No Fill</option>
                <option value="#1a1a1a" data-color="#1a1a1a">Black</option>
                <option value="#4a7c59" data-color="#4a7c59">Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc" selected>White</option>
              </select>
            </div>

            <!-- Text Settings -->
            <div class="tools__item tools__item--text" style="display: none;">
              <select id="text-size-select" class="input input--select" title="Text Size" data-setting="fontSize">
                <option value="12" data-label="Normal">Normal Text (12 pt)</option>
                <option value="26" data-label="Title">Title (26 pt)</option>
                <option value="20" data-label="Header1">Header 1 (20 pt)</option>
                <option value="16" data-label="Header2" selected>Header 2 (16 pt)</option>
                <option value="14" data-label="Header3">Header 3 (14 pt)</option>
              </select>

              <div class="text-style-controls" aria-label="Text Style" style="display:flex; gap:6px; align-items:center;">
                <button type="button" class="tools__button text-style-btn active" data-text-style="none">None</button>
                <button type="button" class="tools__button text-style-btn" data-text-style="bold">Bold</button>
                <button type="button" class="tools__button text-style-btn" data-text-style="italic">Italic</button>
              </div>

              <select id="font-family-select" class="input input--select" title="Font Family" data-setting="fontFamily">
                <option value="Arial" data-font-family="Arial">Arial</option>
                <option value="Times New Roman" data-font-family="Times New Roman">Times New Roman</option>
                <option value="Georgia" data-font-family="Georgia">Georgia</option>
                <option value="Verdana" data-font-family="Verdana">Verdana</option>
                <option value="Tahoma" data-font-family="Tahoma">Tahoma</option>
              </select>

              <select id="text-color-select" class="input input--color" data-color-selector="text" title="Text Color">
                <option value="#1a1a1a" data-color="#1a1a1a" selected>Black</option>
                <option value="#4a7c59" data-color="#4a7c59">Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc">White</option>
              </select>
            </div>

            <!-- Brush Settings -->
            <div class="tools__item tools__item--brush" style="display: none;">
              <input type="number" min="10" max="50" value="20" class="input input--number" title="Brush Size"
                data-setting="size">

              <select id="brush-color-select" class="input input--color" data-color-selector="brush"
                title="Brush Color">
                <option value="#1a1a1a" data-color="#1a1a1a">Black</option>
                <option value="#4a7c59" data-color="#4a7c59" selected>Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc">White</option>
              </select>
            </div>

            <!-- Shapes Settings -->
            <div class="tools__item tools__item--shapes" style="display: none;">
              <select id="shapes-select" class="input input--select" title="Shape Type" data-setting="shapeType">
                <option value="rectangle" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-rectangle.svg">
                  Rectangle</option>
                <option value="triangle" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-triangle.svg">
                  Triangle</option>
                <option value="circle" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-circle.svg">Circle
                </option>
                <option value="ellipse" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-ellipse.svg">
                  Ellipse</option>
                <option value="line" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-line.svg">Line
                </option>
                <option value="arrow" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-arrow.svg">Arrow
                </option>
                <option value="polygon" data-image="/src/assets/icons/coursebuilder/tools/shapes/shape-polygon.svg">
                  Polygon</option>
              </select>

              <input type="number" min="1" max="20" value="2" class="input input--number" title="Shape Thickness"
                data-setting="strokeWidth">


              <select id="shapes-stroke-select" class="input input--color" data-color-selector="shapes-stroke"
                title="Shape Stroke">
                <option value="#1f2937" data-color="#1f2937" selected>Dark Charcoal</option>
                <option value="#4a7c59" data-color="#4a7c59">Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc">White</option>
              </select>

              <select id="shapes-fill-select" class="input input--color" data-color-selector="shapes-fill"
                title="Shape Fill">
                <option value="transparent" data-color="transparent" selected>No Fill</option>
                <option value="#1a1a1a" data-color="#1a1a1a">Black</option>
                <option value="#4a7c59" data-color="#4a7c59">Green</option>
                <option value="#4a79a4" data-color="#4a79a4">Blue</option>
                <option value="#a74a4a" data-color="#a74a4a">Red</option>
                <option value="#6b7280" data-color="#6b7280">Gray</option>
                <option value="#b87333" data-color="#b87333">Orange</option>
                <option value="#7c5a9b" data-color="#7c5a9b">Purple</option>
                <option value="#b8a642" data-color="#b8a642">Yellow</option>
                <option value="#64748b" data-color="#64748b">Slate</option>
                <option value="#f8fafc" data-color="#f8fafc">White</option>
              </select>
            </div>

            <!-- Eraser Settings -->
            <div class="tools__item tools__item--eraser" style="display: none;">
              <input type="number" min="5" max="50" value="20" class="input input--number" title="Eraser Size"
                data-setting="size">
            </div>

            <!-- Table Settings -->
            <div class="tools__item tools__item--tables" style="display: none;">
              <input type="number" min="1" max="20" value="3" class="input input--number" title="Table Size"
                data-setting="size">

              <select class="input input--select" title="Table Type" data-setting="tableType">
                <option value="basic">Basic</option>
                <option value="bordered">Bordered</option>
                <option value="striped">Striped</option>
              </select>
            </div>

            <!-- Scene Settings (Animate Mode) -->
            <div class="tools__item tools__item--scene" style="display: none;">
              <label class="checkbox-container">
                <input type="checkbox" data-setting="loop" title="Loop Animation">
                <span class="checkmark"></span>
                Loop Animation
              </label>

              <select class="input input--select" title="Animation Speed" data-setting="speed">
                <option value="slow">Slow</option>
                <option value="medium" selected>Medium</option>
                <option value="fast">Fast</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Preview View -->
    <div class="coursebuilder__preview" aria-hidden="true" id="preview">
      <article class="content__article content__article--preview">
        <p class="placeholder">Course preview will be displayed here...</p>
      </article>
    </div>

    <!-- Launch View -->
    <div class="coursebuilder__launch" aria-hidden="true" id="launch">
      <article class="content__article content__article--launch">
        <p class="placeholder">Course launch options will be available here...</p>
      </article>
    </div>
  </main>

  <!-- jQuery (required for Select2) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Select2 JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

  <!-- Core application scripts -->
  <script type="module" src="/src/scripts/app.ts"></script>
  <!-- Language loader for course languages -->
  <script type="module" src="/src/scripts/backend/courses/settings/languageLoader.ts"></script>
  <!-- Navigation system (handles all coursebuilder navigation) -->
  <script type="module" src="/src/scripts/navigation/CourseBuilderNavigation.ts"></script>
  <!-- Backend services -->
  <script type="module" src="/src/scripts/backend/courses/index.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/classification/classificationFormHandler.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/templates/createTemplate.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/templates/templateConfigHandler.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/templates/templatePreviewHandler.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/schedule/scheduleCourse.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/settings/pageSetupHandler.ts"></script>
  <script type="module" src="/src/scripts/backend/courses/pedagogy/pedagogyHandler.ts"></script>
  <!-- Media Manager UI (search + providers) -->
  <script type="module" src="/src/scripts/media/ui/MediaInterface.ts"></script>

  <!-- Select2 Configuration -->
  <script>
    $(document).ready(function () {

      // Custom template for Select2 to show only shape images
      function formatShapeOption(state) {
        if (!state.id) { return state.text; }

        var imageUrl = $(state.element).data('image');
        if (!imageUrl) { return state.text; }

        var $state = $(
          '<span><img src="' + imageUrl + '" width="24" height="24" alt="' + state.text + '" style="vertical-align: middle;" /></span>'
        );
        return $state;
      }

      // Custom template for Select2 to show only color swatches
      function formatColorOption(state) {
        if (!state.id) { return state.text; }

        var colorValue = $(state.element).data('color');
        if (!colorValue) { return state.text; }

        // Handle "no fill" option with diagonal red line
        if (colorValue === 'transparent') {
          var $state = $(
            '<span><div style="width: 20px; height: 20px; background: white; border: 1px solid #ccc; border-radius: 3px; display: inline-block; position: relative; overflow: hidden;">' +
            '<div style="position: absolute; top: -1px; left: -1px; width: 28px; height: 2px; background: red; transform: rotate(45deg); transform-origin: 0 0;"></div>' +
            '</div></span>'
          );
          return $state;
        }

        var $state = $(
          '<span><div style="width: 20px; height: 20px; background-color: ' + colorValue + '; border: 1px solid #ccc; border-radius: 3px; display: inline-block;"></div></span>'
        );
        return $state;
      }

      // Custom template for font families with font preview
      function formatFontOption(state) {
        if (!state.id) { return state.text; }

        var fontFamily = $(state.element).data('font-family') || state.text;
        var $state = $(
          '<span style="font-family: ' + fontFamily + '; font-size: 14px;">' + state.text + '</span>'
        );
        return $state;
      }

      // Custom template for line styles
      function formatLineStyleOption(state) {
        if (!state.id) { return state.text; }

        var lineStyle = $(state.element).data('line-style');
        if (!lineStyle) { return state.text; }

        var borderStyle = lineStyle === 'dashed' ? '2px dashed #333' : '2px solid #333';
        var $state = $(
          '<span><div style="width: 30px; height: 0; border-top: ' + borderStyle + '; margin: 10px 0; display: inline-block;"></div></span>'
        );
        return $state;
      }

      // Initialize Select2 for shapes dropdown
      $('#shapes-select').select2({
        templateResult: formatShapeOption,
        templateSelection: function (state) {
          if (!state.id) { return state.text; }

          var imageUrl = $(state.element).data('image');
          if (!imageUrl) { return state.text; }

          var $state = $('<span><img src="' + imageUrl + '" width="24" height="24" alt="' + state.text + '" style="vertical-align: middle;" /></span>');
          return $state;
        },
        minimumResultsForSearch: -1,
        width: '100%'
      });

      // Initialize Select2 for all color dropdowns
      $('#shapes-stroke-select, #shapes-fill-select, #pen-stroke-select, #pen-fill-select, #text-color-select, #brush-color-select').select2({
        templateResult: formatColorOption,
        templateSelection: function (state) {
          if (!state.id) { return state.text; }

          var colorValue = $(state.element).data('color');
          if (!colorValue) { return state.text; }

          // Handle "no fill" option in selection display
          if (colorValue === 'transparent') {
            var $state = $(
              '<span><div style="width: 28px; height: 28px; background: white; border: 1px solid #ccc; border-radius: 4px; display: inline-block; position: relative; overflow: hidden;">' +
              '<div style="position: absolute; top: -1px; left: -1px; width: 40px; height: 3px; background: red; transform: rotate(45deg); transform-origin: 0 0;"></div>' +
              '</div></span>'
            );
            return $state;
          }

          var $state = $('<span><div style="width: 28px; height: 28px; background-color: ' + colorValue + '; border: 1px solid #ccc; border-radius: 4px; display: inline-block;"></div></span>');
          return $state;
        },
        minimumResultsForSearch: -1,
        width: '100%'
      });

      // Initialize Select2 for font family dropdown
      $('#font-family-select').select2({
        templateResult: formatFontOption,
        templateSelection: formatFontOption,
        minimumResultsForSearch: -1,
        width: '100%'
      });

      // Initialize Select2 for text size dropdown
      $('#text-size-select').select2({
        minimumResultsForSearch: -1,
        width: '100%'
      });


      // Handle shape selection change
      $('#shapes-select').on('select2:select', function (e) {
        var data = e.params.data;
        if (window.uiEventHandler && window.uiEventHandler.handleShapeSelection) {
          window.uiEventHandler.handleShapeSelection(data.id);
        }
      });

      // Handle color selection changes
      $('#shapes-stroke-select, #shapes-fill-select, #pen-stroke-select, #pen-fill-select, #text-color-select, #brush-color-select').on('select2:select', function (e) {
        var data = e.params.data;
        var colorSelector = $(this).data('color-selector');

        // Trigger existing color selection logic
        if (window.uiEventHandler && window.uiEventHandler.handleColorChange) {
          window.uiEventHandler.handleColorChange(colorSelector, data.id);
        }
      });

      // Handle font family changes
      $('#font-family-select').on('select2:select', function (e) {
        var data = e.params.data;
        // Trigger existing font family logic
        if (window.uiEventHandler && window.uiEventHandler.handleFontChange) {
          window.uiEventHandler.handleFontChange(data.id);
        }
      });

      // Handle text size preset changes
      $('#text-size-select').on('select2:select', function (e) {
        var data = e.params.data;
        var size = parseInt(data.id, 10) || 16;
        if (window.toolStateManager) {
          window.toolStateManager.updateToolSettings('text', { fontSize: size });
          // Default bold for title/headers
          var label = $(data.element).data('label');
          var makeBold = (label === 'Title' || label === 'Header1' || label === 'Header2' || label === 'Header3');
          if (makeBold) {
            window.toolStateManager.updateToolSettings('text', { fontWeight: 'bold', fontStyle: 'normal' });
            $('.text-style-btn').removeClass('active');
            $('.text-style-btn[data-text-style="bold"]').addClass('active');
          } else {
            window.toolStateManager.updateToolSettings('text', { fontWeight: 'normal', fontStyle: 'normal' });
            $('.text-style-btn').removeClass('active');
            $('.text-style-btn[data-text-style="none"]').addClass('active');
          }
        }
      });

      // Text style buttons
      $('.text-style-btn').on('click', function() {
        var style = $(this).data('text-style');
        $('.text-style-btn').removeClass('active');
        $(this).addClass('active');
        if (window.toolStateManager) {
          if (style === 'bold') {
            window.toolStateManager.updateToolSettings('text', { fontWeight: 'bold', fontStyle: 'normal' });
          } else if (style === 'italic') {
            window.toolStateManager.updateToolSettings('text', { fontWeight: 'normal', fontStyle: 'italic' });
          } else {
            window.toolStateManager.updateToolSettings('text', { fontWeight: 'normal', fontStyle: 'normal' });
          }
        }
      });

      // (Removed stroke type dropdowns for pen and shapes)
    });
  </script>
</body>

</html>

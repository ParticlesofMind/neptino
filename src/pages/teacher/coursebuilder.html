<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Builder - Neptino</title>
    <link rel="stylesheet" href="/src/scss/main.scss">
</head>
<body class="body grid">
    <!-- Special Course Builder Header -->
    <header class="header grid__header">
        <nav class="nav nav--coursebuilder">
            <div class="nav__left-section">
                <button id="previous-btn" class="button button--previous">Courses</button>
            </div>
            
            <div class="nav__center-section">
                <a href="/src/pages/teacher/home.html" class="logo logo--header">
                    <img src="/src/assets/logo/octopus-logo.png" alt="Neptino Logo" class="logo__image">
                </a>
            </div>
            
            <div class="nav__right-section">
                <button id="next-btn" class="button button--succeeding">Next</button>
            </div>
        </nav>
    </header>
 
    <main class="main grid__main">
        <!-- Setup Section (with aside navigation) -->
        <section id="setup" class="section section--active">
            <aside class="aside">
                <nav class="aside__nav">
                    <div class="aside__group aside__group--required">
                        <h3 class="aside__group-title">Required</h3>
                        <ul class="aside__menu">
                            <li class="aside__item">
                                <a href="#essentials" class="aside__link aside__link--active" data-section="essentials">Essentials</a>
                            </li>
                            <li class="aside__item">
                                <a href="#classification" class="aside__link" data-section="classification">Classification</a>
                            </li>
                            <li class="aside__item">
                                <a href="#templates" class="aside__link" data-section="templates">Templates</a>
                            </li>
                            <li class="aside__item">
                                <a href="#schedule" class="aside__link" data-section="schedule">Schedule</a>
                            </li>
                            <li class="aside__item">
                                <a href="#curriculum" class="aside__link" data-section="curriculum">Curriculum</a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="aside__group aside__group--optional">
                        <h3 class="aside__group-title">Optional</h3>
                        <ul class="aside__menu">
                            <li class="aside__item">
                                <a href="#marketplace" class="aside__link" data-section="marketplace">Marketplace</a>
                            </li>
                            <li class="aside__item">
                                <a href="#resources" class="aside__link" data-section="resources">Resources</a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="aside__group aside__group--settings">
                        <ul class="aside__menu">
                            <li class="aside__item">
                                <a href="#settings" class="aside__link" data-section="settings">Settings</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </aside>

        
                <!-- Essentials Article -->
                <article id="essentials" class="article article--active">
                <section class="card">
                    <form class="form" id="course-essentials-form">
                        <div class="form__group">
                            <label class="form__label" for="course-name">Course Name</label>
                            <input class="form__input" type="text" id="course-name" name="course_name" placeholder="Enter course name" required>
                        </div>
                        <div class="form__group">
                            <label class="form__label" for="course-description">Course Description</label>
                            <textarea class="form__input" id="course-description" name="course_description" rows="4" placeholder="Describe what students will learn" required></textarea>
                        </div>
                        <div class="form__group">
                            <label class="form__label" for="teacher-id">Teacher</label>
                            <input class="form__input" type="text" id="teacher-id" name="teacher_id" placeholder="Loading..." readonly>
                        </div>
                        <div class="form__group">
                            <label class="form__label" for="institution">Institution</label>
                            <input class="form__input" type="text" id="institution" name="institution" placeholder="Loading..." readonly>
                        </div>
                        <div class="form__group">
                            <label class="form__label" for="course-language">Course Language</label>
                            <select class="form__input" id="course-language" name="course_language" required>
                                <option value="">Select language...</option>
                            </select>
                        </div>
                        <div class="form__group">
                            <label class="form__label" for="course-image">Course Image</label>
                            <div class="file-upload file-upload--compact">
                                <input type="file" id="course-image" name="course_image" accept="image/*" class="file-upload__input" required>
                                <div class="file-upload__compact-layout">
                                    <label for="course-image" class="file-upload__compact-label">
                                        <span class="file-upload__text">Change course image</span>
                                    </label>
                                    <div class="file-upload__thumbnail" id="image-preview" style="display: none;">
                                        <img id="preview-img" src="" alt="Course preview" class="file-upload__thumbnail-image">
                                        <button type="button" class="file-upload__remove file-upload__remove--compact" id="remove-image">×</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form__actions">
                            <div class="form__actions-row">
                                <button type="submit" id="create-course-btn" class="button button--primary button--disabled" disabled>
                                    Create Course
                                </button>
                                <div class="course-code-display" id="course-code-display" style="display: none;">
                                    <div class="course-code-container">
                                        <span class="course-code-label">Course Code:</span>
                                        <span class="course-code-value" id="course-code-value"></span>
                                        <button type="button" class="course-code-copy-btn" id="course-code-copy-btn" title="Copy course code">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="form__status" id="form-status"></div>
                        </div>
                    </form>
                </section>
            </article>

            <!-- Classification Article -->
            <article id="classification" class="article">
                <section class="card">
                    <form class="form" id="course-classification-form">
                        <!-- Row 1: Class Year + Curricular Framework -->
                        <div class="dropdown-group dropdown-group--classification-row">
                            <div class="form__group">
                                <label class="form__label" for="class-year-dropdown">Class Year</label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="class-year-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select class year...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="class-year-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="class_year" id="class-year-value">
                            </div>
                            
                            <div class="form__group">
                                <label class="form__label" for="curricular-framework-dropdown">Curricular Framework</label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="curricular-framework-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select framework...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="curricular-framework-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="curricular_framework" id="curricular-framework-value">
                            </div>
                        </div>

                        <!-- Row 2: Domain + Subject + Topic + Subtopic -->
                        <div class="dropdown-group dropdown-group--classification-row dropdown-group--with-arrows">
                            <div class="form__group">
                                <label class="form__label" for="domain-dropdown">Domain</label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="domain-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select domain...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="domain-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="domain" id="domain-value">
                            </div>
                            
                            <div class="dropdown-arrow">→</div>
                            
                            <div class="form__group">
                                <label class="form__label" for="subject-dropdown">Subject</label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger dropdown__trigger--disabled" id="subject-dropdown" aria-haspopup="listbox" aria-expanded="false" disabled>
                                        <span class="dropdown__label dropdown__label--placeholder">Select domain first...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="subject-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="subject" id="subject-value">
                            </div>
                            
                            <div class="dropdown-arrow">→</div>
                            
                            <div class="form__group">
                                <label class="form__label" for="topic-dropdown">Topic</label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger dropdown__trigger--disabled" id="topic-dropdown" aria-haspopup="listbox" aria-expanded="false" disabled>
                                        <span class="dropdown__label dropdown__label--placeholder">Select subject first...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="topic-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="topic" id="topic-value">
                            </div>
                            
                            <div class="dropdown-arrow">→</div>
                            
                            <div class="form__group">
                                <label class="form__label" for="subtopic-dropdown">Subtopic <span class="text text--muted">(Optional)</span></label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger dropdown__trigger--disabled" id="subtopic-dropdown" aria-haspopup="listbox" aria-expanded="false" disabled>
                                        <span class="dropdown__label dropdown__label--placeholder">Select topic first...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="subtopic-menu">
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="subtopic" id="subtopic-value">
                            </div>
                        </div>

                        <!-- Row 3: Course Sequence -->
                        <div class="dropdown-group dropdown-group--classification-row">
                            <div class="form__group">
                                <label class="form__label" for="previous-course-dropdown">Previous Course <span class="text text--muted">(Optional)</span></label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="previous-course-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select previous course...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="previous-course-menu">
                                        <div class="dropdown__option dropdown__option--header">Your Courses</div>
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="previous_course" id="previous-course-value">
                            </div>
                            
                            <div class="form__group">
                                <label class="form__label" for="current-course-dropdown">Current Course <span class="text text--muted">(Optional)</span></label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="current-course-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select current course...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="current-course-menu">
                                        <div class="dropdown__option dropdown__option--header">Your Courses</div>
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="current_course" id="current-course-value">
                            </div>
                            
                            <div class="form__group">
                                <label class="form__label" for="next-course-dropdown">Next Course <span class="text text--muted">(Optional)</span></label>
                                <div class="dropdown dropdown--classification">
                                    <button type="button" class="dropdown__trigger" id="next-course-dropdown" aria-haspopup="listbox" aria-expanded="false">
                                        <span class="dropdown__label dropdown__label--placeholder">Select next course...</span>
                                        <span class="dropdown__icon">▼</span>
                                    </button>
                                    <div class="dropdown__menu" role="listbox" id="next-course-menu">
                                        <div class="dropdown__option dropdown__option--header">Your Courses</div>
                                        <!-- Options will be populated by JavaScript -->
                                    </div>
                                </div>
                                <input type="hidden" name="next_course" id="next-course-value">
                            </div>
                        </div>

                        <!-- Last saved indicator -->
                        <div class="form__footer">
                            <div class="save-indicator" id="classification-last-saved">
                                <span class="save-indicator__text" id="classification-save-status">Changes will be saved automatically</span>
                            </div>
                        </div>
                    </form>
                </section>
            </article>

            <!-- Templates Article -->
            <article id="templates" class="article">
                <section class="card">
                    <!-- Template Action Buttons -->
                    <div class="template-header">
                        <div class="template-header__actions">
                            <button id="create-template-btn" class="button button--primary">
                                <span class="button__icon">+</span>
                                Create New Template
                            </button>
                            <button id="load-template-btn" class="button button--secondary">
                                <span class="button__icon">↗</span>
                                Load Template
                            </button>
                        </div>
                    </div>
               
                    <!-- Template Builder Layout -->
                    <div class="template-layout">
                        <div class="template-config">
                            <div class="template-config-placeholder">
                                <h3 class="heading heading--tertiary">Template Configuration</h3>
                                <p class="text">Select or create a template to configure its settings.</p>
                            </div>
                        </div>
                        <div class="template-preview">
                        
                            <div class="preview-container">
                                <div class="preview-placeholder">
                                    <h4 class="preview-placeholder__title">No Template Selected</h4>
                                    <p class="preview-placeholder__text">Create a new template or select an existing one to see the preview here.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </article>

            <!-- Create Template Modal -->
            <div id="create-template-modal" class="modal" style="display: none;">
                <div class="modal__content">
                    <div class="modal__header">
                        <h2 class="modal__title">Create New Template</h2>
                        <button class="modal__close" type="button" onclick="TemplateManager.hideCreateTemplateModal()">&times;</button>
                    </div>
                    <div class="modal__body">
                        <form id="create-template-form" class="form">
                            <div class="form__group">
                                <label class="form__label" for="template-name">Template Name*</label>
                                <input type="text" id="template-name" name="template-name" class="form__input" required placeholder="Enter template name">
                            </div>
                            <div class="form__group">
                                <label class="form__label" for="template-type">Template Type*</label>
                                <select id="template-type" name="template-type" class="form__input" required>
                                    <option value="">Select template type</option>
                                    <option value="lesson">Lesson</option>
                                </select>
                            </div>
                            <div class="form__group">
                                <label class="form__label" for="template-description">Description (Optional)</label>
                                <textarea id="template-description" name="template-description" class="form__input" rows="3" placeholder="Describe your template..."></textarea>
                            </div>
                            <div class="form__actions">
                                <button type="button" class="btn btn--secondary modal__close" onclick="TemplateManager.hideCreateTemplateModal()">Cancel</button>
                                <button type="submit" class="btn btn--primary">Create Template</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Load Template Modal -->
            <div id="load-template-modal" class="modal" style="display: none;">
                <div class="modal__content modal__content--large">
                    <div class="modal__header">
                        <h2 class="modal__title">Load Existing Template</h2>
                        <button class="modal__close" type="button" onclick="TemplateManager.hideLoadTemplateModal()">&times;</button>
                    </div>
                    <div class="modal__body">
                        <div class="template-loader">
                            <div class="template-loader__search">
                                <input type="text" id="template-search" class="form__input" placeholder="Search templates..." />
                                <div class="template-filters">
                                    <select id="template-type-filter" class="form__input form__input--small">
                                        <option value="">All Types</option>
                                        <option value="lesson">Lesson</option>
                                    </select>
                                    <select id="template-sort" class="form__input form__input--small">
                                        <option value="created_at">Newest First</option>
                                        <option value="name">Name (A-Z)</option>
                                        <option value="modified_at">Recently Modified</option>
                                    </select>
                                </div>
                            </div>
                            <div class="template-list-container">
                                <div id="template-loading" class="template-loading" style="display: none;">
                                    <div class="loading-spinner"></div>
                                    <p>Loading your templates...</p>
                                </div>
                                <div id="template-list-content" class="template-list-grid">
                                    <!-- Templates will be loaded here -->
                                </div>
                                <div id="no-templates-message" class="no-templates" style="display: none;">
                                    <div class="no-templates__icon">!</div>
                                    <h3>No Templates Found</h3>
                                    <p>You haven't created any templates yet. Create your first template to get started!</p>
                                    <button class="button button--primary" onclick="TemplateManager.hideLoadTemplateModal(); TemplateManager.showCreateTemplateModal();">
                                        Create First Template
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal__footer">
                        <button type="button" class="button button--secondary" onclick="TemplateManager.hideLoadTemplateModal()">
                            Cancel
                        </button>
                        <button type="button" id="load-selected-template" class="button button--primary" disabled onclick="TemplateManager.loadSelectedTemplate()">
                            Load Template
                        </button>
                    </div>
                </div>
            </div>

            <!-- Schedule Article -->
            <article id="schedule" class="article">
                <section class="card">
            
                    <div class="schedule-layout">
                        <div class="schedule-config">
                            <form class="form">
                                <div class="form__group">
                                    <label class="form__label" for="start-date">Start Date</label>
                                    <input class="form__input" type="date" id="start-date">
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="end-date">End Date</label>
                                    <input class="form__input" type="date" id="end-date">
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="schedule-type">Schedule Type</label>
                                    <select class="form__input" id="schedule-type">
                                        <option value="">Select schedule type</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="bi-weekly">Bi-weekly</option>
                                        <option value="daily">Daily</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="class-time">Class Time</label>
                                    <input class="form__input" type="time" id="class-time">
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="class-duration">Duration (minutes)</label>
                                    <input class="form__input" type="number" id="class-duration" placeholder="e.g., 90">
                                </div>
                            </form>
                        </div>
                        <div class="schedule-preview">
                            <h3 class="heading heading--tertiary">Schedule Preview</h3>
                            <div class="preview-container">
                                <p class="text">Schedule preview will appear here...</p>
                            </div>
                        </div>
                    </div>
                </section>
            </article>

            <!-- Curriculum Article -->
            <article id="curriculum" class="article">
                <section class="card">
                 
                    <div class="curriculum-layout">
                        <div class="curriculum-config">
                            <form class="form">
                                <div class="form__group">
                                    <label class="form__label" for="curriculum-approach">Curriculum Approach</label>
                                    <select class="form__input" id="curriculum-approach">
                                        <option value="">Select approach</option>
                                        <option value="modular">Modular</option>
                                        <option value="linear">Linear</option>
                                        <option value="spiral">Spiral</option>
                                        <option value="project-based">Project-Based</option>
                                    </select>
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="learning-objectives">Learning Objectives</label>
                                    <textarea class="form__input" id="learning-objectives" rows="4" placeholder="List the main learning objectives"></textarea>
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="assessment-methods">Assessment Methods</label>
                                    <textarea class="form__input" id="assessment-methods" rows="3" placeholder="Describe assessment methods"></textarea>
                                </div>
                                <div class="form__group">
                                    <label class="form__label" for="required-materials">Required Materials</label>
                                    <textarea class="form__input" id="required-materials" rows="3" placeholder="List required textbooks, software, etc."></textarea>
                                </div>
                            </form>
                        </div>
                        <div class="curriculum-preview">
                            <h3 class="heading heading--tertiary">Curriculum Preview</h3>
                            <div class="preview-container">
                                <p class="text">Curriculum structure will appear here...</p>
                            </div>
                        </div>
                    </div>
                </section>
            </article>

            <!-- Settings Article -->
            <article id="settings" class="article">
                <section class="card">
             
                    <form class="form">
                        <div class="form__group form__group--checkbox">
                            <input class="form__checkbox" type="checkbox" id="course-visible">
                            <label class="form__label" for="course-visible">Course visible to students</label>
                        </div>
                        <div class="form__group form__group--checkbox">
                            <input class="form__checkbox" type="checkbox" id="allow-enrollment">
                            <label class="form__label" for="allow-enrollment">Allow new enrollments</label>
                        </div>
                        <div class="form__group form__group--checkbox">
                            <input class="form__checkbox" type="checkbox" id="require-approval">
                            <label class="form__label" for="require-approval">Require enrollment approval</label>
                        </div>
                    </form>
                    
                    <div class="danger-zone">
                        <h3 class="heading heading--tertiary">Danger Zone</h3>
                        <p class="text text--danger">Once you delete a course, there is no going back. Please be certain.</p>
                        <button class="button button--danger">Delete Course</button>
                    </div>
                </section>
            </article>

            <!-- Marketplace Article -->
            <article id="marketplace" class="article">
                <section class="card">
                
                    <p class="text">Marketplace integration features will be available here...</p>
                </section>
            </article>

            <!-- Resources Article -->
            <article id="resources" class="article">
                <section class="card">
              
                </section>
            </article>
        </section>

        <!-- Create Section (no aside navigation) -->
        <section id="create" class="section">
            <article class="article article--active">
                <section class="card">
             
                    <p class="text">Course content creation tools will go here...</p>
                </section>
            </article>
        </section>

        <!-- Preview Section (no aside navigation) -->
        <section id="preview" class="section">
            <article class="article article--active">
                <section class="card">
                    <p class="text">Course preview will be displayed here...</p>
                </section>
            </article>
        </section>

        <!-- Launch Section (no aside navigation) -->
        <section id="launch" class="section">
            <article class="article article--active">
                <section class="card">
                    <p class="text">Course launch options will be available here...</p>
                </section>
            </article>
        </section>
    </main>

    <script type="module" src="/src/scripts/app.ts"></script>
    <script type="module" src="/src/scripts/navigation/index.ts"></script>
    <script type="module" src="/src/scripts/backend/courses/index.ts"></script>
    <script type="module" src="/src/scripts/backend/courses/classificationFormHandler.ts"></script>
    <script type="module" src="/src/scripts/backend/courses/createTemplate.ts"></script>
    <script type="module" src="/src/scripts/backend/courses/templates/templateConfigHandler.ts"></script>
    <script type="module" src="/src/scripts/backend/courses/templates/templatePreviewHandler.ts"></script>
</body>
</html>
